---
title: "Weight of Fish"
author: "Tyler Hamblin"
date: "`r Sys.Date()`"  
output: 
  html_document:
    number_sections: true
    toc: true
    toc_depth: 5

 
    
---


```{r include=FALSE,echo=FALSE}
require(tigerstats)
require(tidyverse)
require(car)
require(leaps)
```

# Predicting Fish Weight
```{r}
fish <- read.csv(file = "Fish.csv")
```

```{r eval=TRUE}
 
fish <- fish %>%
mutate(across(where(is.character), as.factor))
levels(fish$Species)
Bream <- filter(fish, Species == "Bream")
Bream <- select(Bream, -Species) 
Parkki <- filter(fish, Species == "Parkki")
Parkki <- select(Parkki, -Species) 
Perch <- filter(fish, Species == "Perch")
Perch <- select(Perch, -Species) 
Pike <- filter(fish, Species == "Pike")
Pike <- select(Pike, -Species) 
Roach <- filter(fish, Species == "Roach")
Roach <- select(Roach, -Species) 
Smelt <- filter(fish, Species == "Smelt")
Smelt <- select(Smelt, -Species) 
Whitefish <- filter(fish, Species == "Whitefish")
Whitefish <- select(Whitefish, -Species) 
```

# For each of the three species of fish listed below, determine the best regression model and also the best 2 element regression model. Use the BestSubset Regression helper file.


## Perch
```{r}
Perch <- filter(fish, Species=="Perch")
Perch <- select(Perch, -(Species))
```

### Best Models
```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Perch,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topright",main="Adjusted R^2")
```


### Best Two regressor model
```{r}
best.model <- lm(Weight~Height+Width,data=Perch)
summary(best.model)
``` 

The model above uses r code to predict a Perch's weight. The first graph shows that the best model for this fishes weight will also be the best two regressor model. The height and width of the fish are used in the element model as the two factors used to predict a Perch's weight. When the adjusted r squared value equals 0.94, there is a plotted point on the 2nd value on the x-axis. 

```{r}
best_Perch_Model <- lm(Weight~Height+Width,data=Perch)
five_element_perch_model <- lm(Weight~.,data=Perch)
anova(best_Perch_Model, five_element_perch_model)
```

The Analysis of Variance shows how the statistics shown in the two element model are most likely significant. This explains why there is not much difference when comparing values for the RSS against a five element model. Model 1 shows height and width as 384478 and model 2 shows Length1, Length2, Length3, Height, and Width is 379369. 


## Pike
```{r}
Pike <- filter(fish, Species=="Pike")
Pike <- select(Pike, -(Species))
```

### Best Models
```{r}
library(leaps)
regsubsets.out <-
    regsubsets(Weight ~ .,
               data = Pike,
               nbest = 1,       # 1 best model for each number of predictors
               nvmax = NULL,    # NULL for no limit on number of variables
               force.in = NULL, force.out = NULL,
               method = "exhaustive")

summary.out <- summary(regsubsets.out)
as.data.frame(summary.out$outmat)
library(car)
subsets(regsubsets.out,statistic="adjr2",legend="topleft",main="Adjusted R^2")
```

The code above is used to determine the best model for the data predicting a Pike's weight. The subset size represents the x-axis, while the adjusted R-squared value represents the y-axis. The legend at the top defines all of the abbreviations and shows the best combination of prediction factors which happens to be 0.98 because it is higher than all the rest. 

### Best Two regressor model
```{r}
Pike_best.model <- lm(Weight~.,data=Pike)
summary(Pike_best.model)
Pike_best_2_R_Model <-lm(Weight~Length1+Length3, data=Pike)
``` 



```{r}
Pike_best.model <- lm(Weight~.,data=Pike)
Pike_best_2_R_Model <-lm(Weight~Length1+Length3, data=Pike)
anova(Pike_best.model, Pike_best_2_R_Model)
```

## Roach

### Best Models

### Best Two regressor model

## Final Summary Statements